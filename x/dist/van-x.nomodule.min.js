{let e,t,r,{fromEntries:n,entries:o,keys:l,getPrototypeOf:i}=Object,{get:f,set:a,deleteProperty:c,ownKeys:s}=Reflect,{state:y,derive:b,add:m}=van,d=i(y()),w=1e3,u=Symbol(),O=Symbol(),j=Symbol(),g=Symbol(),p=Symbol(),S=e=>(e[O]=1,e),P=e=>{if(e?.[O]){let t=y();return b(()=>{newV=e(),t.rawVal instanceof Object&&newV instanceof Object?k(t.rawVal,newV):t.val=newV}),t}return y(v(e))},v=e=>e instanceof Object&&!e[u]?new Proxy((e[u]=n(o(e).map(([e,t])=>[e,P(t)])),e[j]=[],e[g]=y(1),e),{get:(e,t,r)=>i(e[u][t]??0)===d?e[u][t].val:("length"===t&&e[g].val,f(e,t,r)),set(e,t,r,n){let o=e[u];if(t in o)return o[t].val=v(r),1;let l=t in e,i=l&&"length"===t&&r!==e.length;return a(e,t,r)?(l?i&&++e[g].val:a(o,t,P(r))&&(++e[g].val,N(n,t,o[t])),1):void 0},deleteProperty:(e,t)=>(c(e[u],t)&&_(e,t),c(e,t)&&++e[g].val),ownKeys:e=>(e[g].val,s(e))}):e,A=e=>e[u],V=e=>e[u]?new Proxy(e[u],{get:(e,t)=>V(e[t].rawVal)}):e,h=e=>e[j]=e[j].filter(e=>e.t.isConnected),D=(e,t,r,n,{t:o,f:i})=>{let f=Array.isArray(e);if(m(o,()=>o[p][t]=i(r,()=>delete e[t],f?Number(t):t)),f&&!n&&t!=e.length-1){let r=Number(t);o.insertBefore(o.lastChild,o[p][l(e).find(e=>Number(e)>r)])}},N=(e,n,o)=>h(e).forEach(D.bind(t,e,n,o,r)),_=(e,t)=>{for(let r of h(e)){let e=r.t[p];e[t]?.remove(),delete e[t]}},x=r=>(e??(setTimeout(()=>(e.forEach(h),e=t),w),e=new Set)).add(r),K=(e,t,r)=>{let n={t:e(),f:r};t[j].push(n),x(t);for(let[e,r]of o(t[u]))D(t,e,r,1,n);return n.t},k=(e,t)=>{for(let[r,n]of o(t)){let t=e[r];t instanceof Object&&n instanceof Object?k(n,t):e[r]=n}for(let r in e)r in t||delete e[r];let r=l(e);if(Array.isArray(e)||l(t).some((e,t)=>e!==r[t])){for(let{t:t}of h(e)){let{firstChild:e,[p]:n}=t;for(let o of r)e===n[o]?e=e.nextSibling:t.insertBefore(n[o],e)}++e[g]}return e},C=(e,t)=>k(e,Array.isArray(e)?t(e.filter(e=>1)):n(t(o(e)))),E=e=>Array.isArray(e)?e.filter(e=>1).map(E):e instanceof Object?n(o(e).map(([e,t])=>[e,E(t)])):e,F=(e,n)=>{r=1;try{k(e,n)}finally{r=t}};window.vanX={calc:S,reactive:v,stateFields:A,raw:V,list:K,replace:C,compact:E,update:F}}