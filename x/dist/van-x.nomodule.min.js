{let e,t,n,{fromEntries:r,entries:o,keys:l,getPrototypeOf:i}=Object,{get:c,set:a,deleteProperty:s,ownKeys:y}=Reflect,{state:m,derive:b,add:u}=van,d=i(m()),w=1e3,O=Symbol(),j=Symbol(),g=Symbol(),S=Symbol(),p=Symbol(),P=e=>(e[j]=1,e),v=e=>{if(e?.[j]){let t=m();return b(()=>{newV=e(),t.rawVal instanceof Object&&newV instanceof Object?k(t.rawVal,newV):t.val=newV}),t}return m(A(e))},A=e=>e instanceof Object&&!e[O]?new Proxy((e[O]=r(o(e).map(([e,t])=>[e,v(t)])),e[g]=[],e[S]=m(1),e),{get:(e,t,n)=>i(e[O][t]??0)===d?e[O][t].val:("length"===t&&e[S].val,c(e,t,n)),set(e,t,n,r){let o=e[O];if(t in o)return o[t].val=A(n),1;let l=t in e,i=l&&"length"===t&&n!==e.length;return a(e,t,n)?(l?i&&++e[S].val:a(o,t,v(n))&&(++e[S].val,N(r,t,o[t])),1):void 0},deleteProperty:(e,t)=>(s(e[O],t)&&_(e,t),s(e,t)&&++e[S].val),ownKeys:e=>(e[S].val,y(e))}):e,V=e=>e[O],h=e=>e[O]?new Proxy(e[O],{get:(e,t)=>h(e[t].rawVal)}):e,D=e=>e[g]=e[g].filter(e=>e.t.isConnected),F=(e,t,n,r,{t:o,f:i})=>{let f=Array.isArray(e);if(u(o,()=>o[p][t]=i(n,()=>delete e[t],f?Number(t):t)),f&&!r&&t!=e.length-1){let n=Number(t);o.insertBefore(o.lastChild,o[p][l(e).find(e=>Number(e)>n)])}},N=(e,r,o)=>D(e).forEach(F.bind(t,e,r,o,n)),_=(e,t)=>{for(let n of D(e)){let e=n.t[p];e[t]?.remove(),delete e[t]}},x=n=>(e??(setTimeout(()=>(e.forEach(D),e=t),w),e=new Set)).add(n),K=(e,t,n)=>{let r={t:e instanceof Function?e():e,f:n};t[g].push(r),x(t);for(let[e,n]of o(t[O]))F(t,e,n,1,r);return r.t},k=(e,t)=>{for(let[n,r]of o(t)){let t=e[n];t instanceof Object&&r instanceof Object?k(r,t):e[n]=r}for(let n in e)n in t||delete e[n];let n=l(e);if(Array.isArray(e)||l(t).some((e,t)=>e!==n[t])){for(let{t:t}of D(e)){let{firstChild:e,[p]:r}=t;for(let o of n)e===r[o]?e=e.nextSibling:t.insertBefore(r[o],e)}++e[S]}return e},C=(e,l)=>{l instanceof Function&&(l=Array.isArray(items)?f(items.filter(e=>1)):r(f(o(items)))),n=1;try{return k(e,l)}finally{n=t}},E=e=>Array.isArray(e)?e.filter(e=>1).map(E):e instanceof Object?r(o(e).map(([e,t])=>[e,E(t)])):e;window.vanX={calc:P,reactive:A,stateFields:V,raw:h,list:K,replace:C,compact:E}}