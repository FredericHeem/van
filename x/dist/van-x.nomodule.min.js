{let e,t,r,{fromEntries:o,entries:n,keys:l,getPrototypeOf:f}=Object,{get:i,set:c,deleteProperty:a,ownKeys:s}=Reflect,{state:y,derive:b,add:m}=van,d=f(y()),u=1e3,w=Symbol(),O=Symbol(),j=Symbol(),S=Symbol(),g=Symbol(),p=Symbol(),P=e=>(e[j]=1,e),v=e=>{if(e?.[j]){let t=y();return b(()=>{let r=e();t.rawVal instanceof Object&&r instanceof Object?E(t.rawVal,r):t.val=A(r)}),t}return y(A(e))},A=e=>e instanceof Object&&!e[O]?new Proxy((e[w]=e,e[O]=o(n(e).map(([e,t])=>[e,v(t)])),e[S]=[],e[g]=y(1),e),{get:(e,t,r)=>f(e[O][t]??0)===d?e[O][t].val:("length"===t&&e[g].val,i(e,t,r)),set(e,t,r,o){let n=e[O];if(t in n)return n[t].val=A(r),1;let l=t in e,f=l&&"length"===t&&r!==e.length;return c(e,t,r)?(l?f&&++e[g].val:c(n,t,v(r))&&(++e[g].val,_(o,t,n[t])),1):void 0},deleteProperty:(e,t)=>(a(e[O],t)&&x(e,t),a(e,t)&&++e[g].val),ownKeys:e=>(e[g].val,s(e))}):e,h=e=>e[O],D=e=>e[O]?new Proxy(e[O],{get:(e,t)=>D(e[t].rawVal)}):e,F=e=>e[S]=e[S].filter(e=>e.t.isConnected),N=(e,t,r,o,{t:n,f:f})=>{let i=Array.isArray(e);if(m(n,()=>n[p][t]=f(r,()=>delete e[t],i?Number(t):t)),i&&!o&&t!=e.length-1){let r=Number(t);n.insertBefore(n.lastChild,n[p][l(e).find(e=>Number(e)>r)])}},_=(e,o,n)=>F(e).forEach(N.bind(t,e,o,n,r)),x=(e,t)=>{for(let r of F(e)){let e=r.t[p];e[t]?.remove(),delete e[t]}},K=r=>(e??(setTimeout(()=>(e.forEach(F),e=t),u),e=new Set)).add(r),k=(e,t,r)=>{let o={t:e instanceof Function?e():e,f:r};o.t[p]={},t[S].push(o),K(t);for(let[e,r]of n(t[O]))N(t,e,r,1,o);return o.t},C=(e,t)=>{for(let[r,o]of n(t)){let t=e[r];t instanceof Object&&o instanceof Object?C(t,o):e[r]=o}for(let r in e)r in t||delete e[r];let r=l(t),o=Array.isArray(e);if(o||l(e).some((e,t)=>e!==r[t])){if(o)e.length=t.length;else{++e[g].val;let t=e[w],o={...t};for(let e of r)delete t[e];for(let e of r)t[e]=o[e]}for(let{t:t}of F(e)){let{firstChild:e,[p]:o}=t;for(let n of r)e===o[n]?e=e.nextSibling:t.insertBefore(o[n],e)}}return e},E=(e,l)=>{l instanceof Function&&(l=Array.isArray(e)?l(e.filter(e=>1)):o(l(n(e)))),r=1;try{return C(e,l)}finally{r=t}},R=e=>Array.isArray(e)?e.filter(e=>1).map(R):e instanceof Object?o(n(e).map(([e,t])=>[e,R(t)])):e;window.vanX={calc:P,reactive:A,stateFields:h,raw:D,list:k,replace:E,compact:R}}