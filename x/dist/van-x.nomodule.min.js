{let e,t,r,{fromEntries:o,entries:n,keys:l,hasOwn:f,getPrototypeOf:a}=Object,{get:i,set:c,deleteProperty:s,ownKeys:y}=Reflect,{state:b,derive:m,add:d}=van,u=1e3,w=Symbol(),O=Symbol(),j=Symbol(),A=Symbol(),_=Symbol(),g=e=>(e[O]=1,e),p=e=>{if(e?.[O]){let t=b();return m(()=>{let r=e();t.rawVal instanceof Object&&r instanceof Object?C(t.rawVal,r):t.val=P(r)}),t}return b(P(e))},S=e=>{let t=Array.isArray(e)?[]:{__proto__:a(e)};for(let[r,o]of n(e))t[r]=p(o);return t[j]=[],t[A]=b(1),t},P=e=>e instanceof Object&&!e[w]?new Proxy(S(e),{get:(e,t,r)=>t===w?e:f(e,t)?Array.isArray(e)&&"length"===t?(e[A].val,e.length):e[t].val:i(e,t,r),set:(e,o,n,l)=>f(e,o)?Array.isArray(e)&&"length"===o&&n!==e.length?(e.length=n,++e[A].val):(e[o].val=P(n),1):o in e?c(e,o,n,l):c(e,o,p(n))&&(++e[A].val,D(e).forEach(F.bind(t,l,o,e[o],r)),1),deleteProperty:(e,t)=>(s(e,t)&&x(e,t),++e[A].val),ownKeys:e=>(e[A].val,y(e))}):e,h=e=>e[w],v=e=>e[w]?new Proxy(e[w],{get:(e,t)=>v(e[t].rawVal)}):e,D=e=>e[j]=e[j].filter(e=>e.t.isConnected),F=(e,t,r,o,{t:n,f:f})=>{let a=Array.isArray(e),i=a?Number(t):t;d(n,()=>n[_][t]=f(r,()=>delete e[t],i)),a&&!o&&i!==e.length-1&&n.insertBefore(n.lastChild,n[_][l(e).find(e=>Number(e)>i)])},x=(e,t)=>{for(let r of D(e)){let e=r.t[_];e[t]?.remove(),delete e[t]}},K=r=>(e??(setTimeout(()=>(e.forEach(D),e=t),u),e=new Set)).add(r),N=(e,t,r)=>{let o={t:e instanceof Function?e():e,f:r},l=t[w];o.t[_]={},l[j].push(o),K(l);for(let[e,r]of n(l))F(t,e,r,1,o);return o.t},k=(e,t)=>{for(let[r,o]of n(t)){let t=e[r];t instanceof Object&&o instanceof Object?k(t,o):e[r]=o}for(let r in e)f(t,r)||delete e[r];let r=l(t),o=Array.isArray(e);if(o||l(e).some((e,t)=>e!==r[t])){let n=e[w];if(o)e.length=t.length;else{++n[A].val;let e={...n};for(let e of r)delete n[e];for(let t of r)n[t]=e[t]}for(let{t:e}of D(n)){let{firstChild:t,[_]:o}=e;for(let n of r)t===o[n]?t=t.nextSibling:e.insertBefore(o[n],t)}}return e},C=(e,l)=>{r=1;try{return k(e,l instanceof Function?Array.isArray(e)?l(e.filter(e=>1)):o(l(n(e))):l)}finally{r=t}},E=e=>Array.isArray(e)?e.filter(e=>1).map(E):e instanceof Object?o(n(e).map(([e,t])=>[e,E(t)])):e;window.vanX={calc:g,reactive:P,stateFields:h,raw:v,list:N,replace:C,compact:E}}